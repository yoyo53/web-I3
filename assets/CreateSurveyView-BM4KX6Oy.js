import{R as T,C as E}from"./CheckBox-BaWtnXml.js";import{_ as f,o as a,c as i,d as u,v as h,a as s,F as v,h as w,t as b,g as m,f as k,r as p,i as q,j as g}from"./index-kY_OSmlO.js";const B={data(){return{isOpen:!1,search:"",selected:null,templates:[]}},computed:{filteredItems(){return this.templates.filter(t=>t.name.toLowerCase().includes(this.search.toLowerCase()))}},mounted(){this.getallTemplates()},methods:{selectItem(t){this.selected=t,this.search=t.name,this.isOpen=!1,this.$emit("template-selected",t)},closeDropdown(){setTimeout(()=>{this.isOpen=!1},150)},async getallTemplates(){try{const e=await(await fetch("https://web-i3-back.fly.dev/admin/templates",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();this.templates=e,console.log(e)}catch(t){console.error(t)}}}},S={class:"relative w-64"},N={key:0,class:"absolute z-10 w-full mt-1 bg-white border rounded-md shadow-sm px-4 py-2 text-gray-700"},O={class:"max-h-48 overflow-y-auto"},V=["onClick"],I={key:0,class:"px-4 py-2 text-gray-500"};function U(t,e,d,y,o,n){return a(),i("div",S,[u(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>o.search=l),onFocus:e[1]||(e[1]=l=>o.isOpen=!0),onBlur:e[2]||(e[2]=(...l)=>n.closeDropdown&&n.closeDropdown(...l)),placeholder:"Rechercher ou sélectionner...",class:"w-full px-4 py-2 border rounded shadow focus:outline-none"},null,544),[[h,o.search]]),o.isOpen?(a(),i("div",N,[s("ul",O,[(a(!0),i(v,null,w(n.filteredItems,l=>(a(),i("li",{key:l.survey_templateID,onClick:x=>n.selectItem(l),class:"px-4 py-2 cursor-pointer hover:bg-gray-100"},b(l.name),9,V))),128)),n.filteredItems.length===0?(a(),i("li",I," Aucun résultat trouvé ")):m("",!0)])])):m("",!0)])}const F=f(B,[["render",U]]),D={data(){return{isEditable:!1,templateName:"",questions:[],errors:{}}},components:{RadioButton:T,CheckBox:E,searchBar:F},methods:{modifyForm(){this.isEditable=!this.isEditable},addQuestion(){this.questions.push({question_text:"",question_type:"text",options:[]}),console.log(this.questions)},updateOptions(t,e){t.options=e},validateFields(){this.errors={};let t=!0;return this.templateName.trim()||(this.errors.templateName="Template name is required.",t=!1),this.questions.forEach(e=>{e.question_type==="text"&&!e.text.trim()&&(this.errors[`question_${e.id}`]="Question text is required.",t=!1)}),t},handleTemplateSelected(t){this.templateName=t.name,console.log(t.name,t.survey_templateID),this.getTemplate(t.survey_templateID)},async getTemplate(t){try{(await fetch(`https://web-i3-back.fly.dev/admin/templates/${t}`)).json().then(d=>{console.log(d.questions),this.questions=d.questions})}catch(e){console.error(e)}},submitTemplate(){this.validateFields()&&console.log({templateName:this.templateName,questions:this.questions})}}},R={class:"mb-6"},j={key:0,class:"text-red-500 text-sm mt-1"},Q={class:"flex justify-between items-center"},A={class:"block text-sm font-medium text-gray-700 mb-2"},L=["onUpdate:modelValue","disabled"],M=["onUpdate:modelValue","disabled"],$=["disabled"];function z(t,e,d,y,o,n){const l=p("searchBar"),x=p("RadioButton"),C=p("CheckBox");return a(),i("form",null,[s("div",R,[e[4]||(e[4]=s("label",{for:"template-name",class:"block text-sm font-medium text-gray-700 mb-2"}," Survey Name ",-1)),u(s("input",{type:"text",id:"template-name","onUpdate:modelValue":e[0]||(e[0]=r=>o.templateName=r),class:"block w-full px-4 py-2 border rounded-md shadow-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter template name"},null,512),[[h,o.templateName]]),o.errors.templateName?(a(),i("div",j,b(o.errors.templateName),1)):m("",!0),s("div",Q,[k(l,{class:"py-2",onTemplateSelected:n.handleTemplateSelected},null,8,["onTemplateSelected"]),s("button",{onClick:e[1]||(e[1]=(...r)=>n.modifyForm&&n.modifyForm(...r)),class:"ml-4 py-2 px-4 bg-primary font-semibold text-white rounded-md shadow-md hover:bg-primary-hover transition duration-300"}," Modify Form ")])]),(a(!0),i(v,null,w(o.questions,(r,_)=>(a(),i("div",{key:_,class:"mb-4 p-4 border-2 border-dashed border-transparent-hover rounded-lg"},[s("label",A,"Question "+b(_+1),1),s("div",null,[u(s("input",{type:"text","onUpdate:modelValue":c=>r.question_text=c,disabled:!o.isEditable,class:"block w-full px-4 py-2 border rounded-md shadow-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-2",placeholder:"Enter question"},null,8,L),[[h,r.question_text]])]),e[6]||(e[6]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Response Type",-1)),u(s("select",{"onUpdate:modelValue":c=>r.question_type=c,disabled:!o.isEditable,class:"block w-full px-4 py-2 border rounded-md shadow-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"},e[5]||(e[5]=[s("option",{value:"text"},"Text Input",-1),s("option",{value:"stars"},"Star Rating (1-5)",-1),s("option",{value:"radio"},"Radio Buttons",-1),s("option",{value:"checkbox"},"Checkbox",-1)]),8,M),[[q,r.question_type]]),r.question_type==="radio"?(a(),g(x,{key:0,question:r,isEditable:o.isEditable,onUpdateOptions:n.updateOptions},null,8,["question","isEditable","onUpdateOptions"])):m("",!0),r.question_type==="checkbox"?(a(),g(C,{key:1,question:r,isEditable:o.isEditable,onUpdateOptions:n.updateOptions},null,8,["question","isEditable","onUpdateOptions"])):m("",!0)]))),128)),s("button",{onClick:e[2]||(e[2]=(...r)=>n.addQuestion&&n.addQuestion(...r)),disabled:!o.isEditable,class:"w-full py-2 px-4 bg-primary font-semibold text-[white] rounded-md shadow-md hover:bg-primary-hover transition duration-300"}," Add Question ",8,$),s("button",{onClick:e[3]||(e[3]=(...r)=>n.submitTemplate&&n.submitTemplate(...r)),class:"mt-4 w-full py-2 px-4 bg-transparent font-semibold text-[primary] rounded-md shadow-md hover:bg-transparent-hover transition duration-300"}," Submit Template ")])}const G=f(D,[["render",z]]),H={components:{CreateSurveyComponent:G}},J={class:"min-h-screen p-8 flex justify-center items-start"},K={class:"bg-white shadow-md rounded-lg p-6 w-full max-w-3xl"};function P(t,e,d,y,o,n){const l=p("CreateSurveyComponent");return a(),i("div",J,[s("div",K,[e[0]||(e[0]=s("h1",{class:"text-2xl font-semibold text-[primary] mb-4"},"Create Survey",-1)),k(l)])])}const Y=f(H,[["render",P]]);export{Y as default};
