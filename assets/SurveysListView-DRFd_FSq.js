import{P as g}from"./PopupComponent-CIPWKyjQ.js";import{u as h,_ as v,o as r,c as u,a as s,F as b,f as k,b as p,w as S,h as C,j as x,t as i,r as l,k as y,d as T}from"./index-Cjt9ijAu.js";const f=h(),A={name:"SurveysListComponent",inject:["userState"],props:{surveys:{type:Array,required:!0}},data(){return{showPopup:!1,selectedSurvey:null}},components:{PopupComponent:g},methods:{getSurveyRoute(){return this.userState.userType==="Admin"?"adminSurveyView":this.userState.userType==="Teacher"?"teacherSurveyView":"studentSurveyView"},async deleteSurvey(t){try{const e=await fetch("https://web-i3-back.fly.dev/admin/survey/"+t,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error(e.statusText);this.$emit("removeSurvey"),f.success("Survey deleted successfully")}catch(e){console.error(e),f.error("Something went wrong")}},openModal(t){this.selectedSurvey=t,this.showPopup=!0},closeModal(){this.showPopup=!1}}},L={class:"space-y-4"},R=["onClick"],V={class:"flex min-w-0 gap-x-4"},j={class:"min-w-0 flex-auto"},M={class:"text-sm/6 font-semibold"},P={class:"mt-1 text-xs/5 text-neutral-500"},E={class:"text-end"},B={class:"mt-1 text-xs/5 text-neutral-500"};function $(t,e,m,_,a,o){const c=l("RouterLink"),d=l("PopupComponent");return r(),u("div",null,[s("ul",L,[(r(!0),u(b,null,k(m.surveys,(n,w)=>(r(),u("li",{key:w},[p(c,{to:{name:o.getSurveyRoute(),params:{id:n.surveyID}},class:"p-4 block border border-neutral-300 rounded-lg bg-neutral-50 cursor-pointer transition-transform duration-200 ease-in-out hover:bg-neutral-100 hover:-translate-y-1 hover:shadow-md focus:outline-none focus:ring-offset-2 focus:ring-2 focus:ring-efrei-blue-700"},{default:S(()=>[o.userState.userType==="Admin"?(r(),u("button",{key:0,type:"button",onClick:C(O=>o.openModal(n),["prevent"]),class:"text-red-400 hover:text-red-500 font-semibold rounded-lg focus:outline-none focus:ring-offset-4 focus:ring-2 focus:ring-red-700"}," Remove ",8,R)):x("",!0),s("div",V,[s("div",j,[s("p",M,"Subject: "+i(n.subject),1),s("p",P,i(n.firstname)+" "+i(n.lastname),1)]),s("div",E,[e[1]||(e[1]=s("p",{class:"text-sm/6"},"Group",-1)),s("p",B,i(n.group),1)])])]),_:2},1032,["to"])]))),128))]),p(d,{isOpen:a.showPopup,popUpText:"Are you sure you want to delete this survey ? This will also delete all associated answers",onCloseModal:o.closeModal,onConfirmAction:e[0]||(e[0]=n=>o.deleteSurvey(a.selectedSurvey.surveyID))},null,8,["isOpen","onCloseModal"])])}const N=v(A,[["render",$]]),D=h(),I={name:"SurveysListView",inject:["userState"],data(){return{surveys:[]}},components:{SurveysListComponent:N},methods:{async fetchAllSurveys(){try{let t;this.userState.userType==="Admin"?t="admin/surveys":this.userState.userType==="Teacher"?t="teacher/surveys":t="student/surveys";const e=await fetch("https://web-i3-back.fly.dev/"+t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error(e.statusText);this.surveys=await e.json()}catch(t){console.error(t),D.error("Something went wrong")}}},beforeMount(){this.fetchAllSurveys()}},z={class:"my-12"},F={key:1,class:"text-gray-500 text-sm text-center"};function G(t,e,m,_,a,o){const c=l("RouterLink"),d=l("SurveysListComponent");return r(),u("div",null,[s("section",z,[e[1]||(e[1]=s("h1",{class:"my-6 text-3xl font-semibold text-center"},"Surveys",-1)),o.userState.userType==="Admin"?(r(),y(c,{key:0,to:{name:"adminSurveyCreate"},class:"block w-full max-w-7xl mx-auto rounded-md text-center my-4 px-4 py-2 text-sm/6 font-semibold text-white shadow-sm bg-efrei-blue-500 hover:bg-efrei-blue-950 focus:outline-none focus:ring-offset-2 focus:ring-2 focus:ring-efrei-blue-700"},{default:S(()=>e[0]||(e[0]=[T(" Create a Survey ")])),_:1})):x("",!0),a.surveys.length===0?(r(),u("div",F,"No surveys yet")):(r(),y(d,{key:2,class:"max-w-7xl mx-auto",surveys:a.surveys,onRemoveSurvey:o.fetchAllSurveys},null,8,["surveys","onRemoveSurvey"]))])])}const H=v(I,[["render",G]]);export{H as default};
